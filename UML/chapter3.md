# 第三章 UML的关系  
用例图,类图,时序图,状态图,活动图,主要讨论类图
## 3.1 概述
对象模型中,类不可能孤立存在,类与类之间必然以某种方式产生联系,也就是说类与类一定存在某种协作或互动.
类之间的关系有四种:
1. 依赖关系(Dependency): 描述类之间的使用关系
2. 类属关系(Generalization): 描述类之间的"一般"与"特殊"关系
3. 关联关系(Association): 描述类之间的结构关系(成员关系),is-a关系
4. 实现关系(Realization): 描述了定义协议的元素和遵循协议的元素之间的关系,典型的是接口和实现类
## 3.2 依赖关系(Dependency)
如果一个模型元素的变化会影响另一个模型元素(这种影响不可逆),那么就说这两个模型元素之间存在依赖关系,一般是单向的  
符号: ------>  
可以通过对象间的引用类型有效区分关联关系和依赖关系,引用的四种方式如下:
1. 属性引用: B对象作为A对象的某个属性,就有A到B的关联关系  
2. 参数引用: B对象作为A对象嗯对某个操作的参数,这种A与B的短暂的,临时性的关系即依赖关系  
3. 局部声明引用: B对象作为A对象某个操作内部临时构造的对象,这也是一种临时性的关系,称为依赖关系
4. 全局对象: B对象是一个全局对象,任何其他对象都可以直接向B对象发送消息,系统中任何其他对象都有到该全局对象的依赖关

综上所述,在类图中,有四种情形的依赖关系:
1. a类的某个方法的形参是c类对象(参数引用)
2. a类的某个方法返回值是b类对象(局部声明引用)
3. a类某个方法的方法体中动态穿件了b类对象(局部声明引用)
4. b对象是一个全局对象(全局引用)
### 衍型1
依赖关系是一种使用关系,表示一个类对象使用另一个类对象的信息和服务,被使用对象的变化可能会影响到使用对象,是耦合度最低的一种关系  
依赖的语义较弱,为了区分不同类型的以来,可以通过引入构造来细化不同类型的依赖关系  
UMl定义了许多可以应用于依赖关系的衍型(构造型),详细见书P35,了解即可
- 用于类图中雷雨对象之间依赖关系的衍型
    - 绑定<\<bind>>:用给定的实际参数实例化目标模版。
    - 导出<\<derive>>:表明源(依赖)事物可以从目标(被依赖)事物导出(一般建议删掉,不建议导出关联)

### 衍型2
- 可以用于包间依赖关系的衍型
- 可以用于用例之间依赖关系的的衍型
- 可以用于为对象间的交互作用的衍型
- 可以用于状态机的上下文中的衍型

**依赖倒置原则**,依赖关系依赖于抽象而不依赖于具体。

## 3.3 类属关系
类属关系描述了一般事物与该事物的特殊种类之间的关系,也即父元素与子元素之间的关系  
在UML中,雷叔关系用空心箭头的视线表示,箭头指向父元素。  
----------|>  
类属关系有三个特征:  
- 特殊元素(子类)汇集成一般元素(父类)的所有特征
- 特殊元素(子类)还应该包含额外的信息
- 一般元素(父类)出现的位置,换成特殊元素(子类)系统会正常运行(里氏代还原则)

类属关系是关联关系的特例,是类之间耦合度最高的关系。是"is-a"的关系  
单继承,多继承  
多个类的继承关系可以构成一个继承树,接口是对一个组件(类,模块)的业务逻辑的最高抽象  
设计模式中的"依赖倒置原则"鼓励**面向接口编程**和**要依赖于抽象,不要依赖于具体**;"组合服用原则"鼓励**多使用组合/聚合实现复用,少使用继承复用**

## 3.4 关联关系
关联关系表示两个类之间存在某种语义上的联系。他是一种结构关系,规定了一种事物的对象可以与另一种事物的对象相连(link)。  

    譬如教师和和课程之间的讲授关系,学生和课程之间的选修关系
    关联关系是类之间最普遍的一种关系,并且是一种稳定的语义联系
    继承关系和组合/聚合关系是关联的特例,属于强关联
    依赖关系不属于关联关系
    语义最弱的是依赖关系

关联关系的UML符号是一条实线  
**----------------------**  
角色(role),阶元(multiplicity)和关联类(association class)
- 关联两头的类都以某种角色参与关联(未标明角色名就隐式表示类名作为角色)
- 阶元(多重度)表示与多少个对象参与该关联。***//阶元的表示可以是0..\*(等价于\*),1..\*,1..10,2..8,1,3,5(连续或者不连续的数字范围)***
- 关联类

    关联关系代表了类之间的语义联系,而这种语义联系也可能存在一些属性信息,UML用关联类来表示这些信息。

- 导航

    关联关系是可导航的以为这给定一端的一个对象,可以容易,直接地到达另一端的对象,因为源对象通常含有对目标对象的引用。  
    关联关系可以有方向,以表示该关联被单方向使用。  
    UML建议使用单向关联,少用双向关联

- 受限关联(限定符)

    - 如果两个类之间存在关联关系,一个类的对象就可以看见并导航到另一个类的对象,除非有所限制,如限制导航为单向导航
    - 可见性:某些情况下,需要限制关联外部的对象对于该关联可见性,有三种可见性,公共,私有合保护可见性  
   -  受限关联用于一对多或多对多的关联.限定符(也叫限定子)用来区分关联"多"端的对象集合,它指明了在关联"多"端的某个特殊对象  
    限定符画成一个小方块,位于靠近受限方的关联末端  
    受限关联将模型中的一对多关系简化为一对一,将多对多简化为多对一
    - 接口说明符  
    用来规定类或组件服务的操作机的说明符。

- 聚合关系

    聚合关系是一种特殊的关联关系。聚合表示类之间的关系是整体与部分的关系,它代表了"is-a"(拥有)关系,也即作为整体的对象拥有作为部分的对象

- 组合关系

    组合是聚合的变种,它加入了一些重要的语义  
    在组合关系中,整体与部分之间都具有很强的所有关系和一致的生命周期

- 实现关系
